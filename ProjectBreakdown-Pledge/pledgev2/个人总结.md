# 知识点
## 基础知识
在 Web3 借贷协议中，这两个角色的定义非常明确：  
Lend (Lender / 出借方)： 存钱的人（提供流动性，赚取利息）。  
Borrow (Borrower / 借款方)： 借钱的人（存入抵押品，换取资金使用权）。 

## “单次池” vs “流动性池” 对比

|特性|你代码中的单次池 (Discrete)|Aave/Compound (Vaults)|
|--|---|---|
|利率|预设固定利率，不随借贷人数变化|随供需关系实时动态调整|
|期限|有明确到期日，类似“债券”|无到期日，随时借还|
|资金利用率|资金在 MATCH 期可能闲置|资金一直处于流动状态|
|清算逻辑|针对该批次抵押品统一监控|针对每个用户的健康系数监控|

## PoolDataInfo
|字段后缀|逻辑视角|常见代币|
|--|---|---|
|Lend|出借方的钱（本+息）|通常是稳定币 (BUSD/USDT)|
|Borrow|借款方的债/抵押物|通常是波动资产 (BTC/ETH)|


## 核心设计意图分析
1、防纠纷记账： 在去中心化协议中，一旦进入清算，由于抵押物价格波动，最终能分给用户的钱是不确定的。记录 liquidationAmountLend 可以让前端展示：“由于发生了清算，您原本应得的 100 USDT 变为了 95 USDT”。

2、资产分离： 这种设计允许协议支持“非足额募集”。比如我想借 100 万，但只来了 50 万。settleAmountLend 记录 50 万，后续所有的利息和清算门槛都会按 50 万重新标定，而不是按原定的 100 万。

3、支持 spCoin/jpCoin 的兑换率计算：

    spCoin 的价值 = finishAmountLend / spCoin.totalSupply()

    通过这些 Data 字段，合约能实时算出每一枚凭证代币到底值多少钱。


PoolBaseInfo 是规则（利率是多少、什么时候结束），而 PoolDataInfo 是结果（最后剩了多少钱、清算回多少钱）。

## 业务场景模拟 BorrowInfo

|动作|资金变化|状态更新|
|--|---|---|
|1. 抵押阶段|存入 100 BTC|stakeAmount = 100|
|2. 结算时刻|只有 80% 匹配成功|refundAmount = 20|
|3. 用户退款|领回 20 BTC|hasNoRefund = true|
|4. 用户领钱|领走借到的 BUSD|hasNoClaim = true|
|5. 到期还钱|还回 BUSD|赎回剩余 80 BTC|
 